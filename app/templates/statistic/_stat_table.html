{% if matrix %}
  <table border="1" cellspacing="0" cellpadding="4">
    {% for row in matrix %}
      <tr>
        {% for cell in row %}
          {% if heatmap %}
            <td data-alpha="{{ cell }}">
              {{ (cell * 100) | round(1) }}%
            </td>
          {% else %}
            {% if cell == 0 %}  
              <td> 0 </td>
            {% elif cell == 1 %}
              <td> 1 </td>
            {% elif cell == 2 %}
              <td> x </td>
            {% elif cell == 3 %}
              <td> ~ </td>
            {% elif cell == 4 %}
              <td> . </td>
            {% endif %}
          {% endif %}
        {% endfor %}
      </tr>
    {% endfor %}
  </table>
{% else %}
  <p>Chưa có dữ liệu hiển thị.</p>
{% endif %}



{# Hiện màu đẹp hơn, nhưng đừng hỏi làm thế nào ạ#}
<script>
const alphas = Array.from(document.querySelectorAll('td[data-alpha]')).map(td => parseFloat(td.dataset.alpha));
const minA = Math.min(...alphas);
const maxA = Math.max(...alphas);

document.querySelectorAll('td[data-alpha]').forEach(td => {
  let a = parseFloat(td.dataset.alpha);
  a = (a - minA) / (maxA - minA); // chuẩn hóa 0-1
  td.style.backgroundColor = `rgba(255, 0, 0, ${a})`;
});
</script>